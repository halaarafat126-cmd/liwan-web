<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
 <meta charset="UTF-8">
 <title>Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© Ø§Ù„Ø¹Ø§Ù…Ø© | Ù„ÙŠÙˆØ§Ù†</title>
 <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"/>
 <link href="https://fonts.googleapis.com/css?family=Tajawal:wght@500;700&display=swap" rel="stylesheet">
 <meta name="viewport" content="width=device-width, initial-scale=1.0">
 <style>
   body {
     margin:0;
     padding:0;
     font-family: 'Tajawal', Arial, sans-serif;
     background:#f6f3ef;
     display:flex;
     justify-content:center;
     align-items:flex-start;
     min-height:100vh;
   }
   /* ===== Sidebar ===== */
   .liwan-sidenav {
     position: fixed;
     left: 0;
     top: 0;
     width: 80px;
     height: 100vh;
     background: #4c6b82;
     display: flex;
     flex-direction: column;
     align-items: center;
     justify-content: center;
     z-index: 1000;
     box-shadow: 2px 0 18px rgba(40,54,90,0.07);
   }
   .liwan-sidenav ul {
     list-style: none;
     margin: 0;
     padding: 0;
     display: flex;
     flex-direction: column;
     align-items: center;
   }
   .liwan-sidenav li {
     margin-bottom: 24px;
     width: 100%;
     display: flex;
     justify-content: center;
     position: relative;
   }
   .liwan-side-link {
     position: relative;
     display: flex;
     align-items: center;
     justify-content: center;
     width: 60px;
     height: 60px;
     border-radius: 12px;
     color: #f8ebd7;
     font-size: 24px;
     text-decoration: none;
     cursor: pointer;
     transition: background 0.15s, box-shadow 0.18s;
   }
   .liwan-side-link:hover {
     background: #365069;
     box-shadow: 0 3px 18px rgba(31,59,77,0.13);
   }
   .liwan-side-link .liwan-icon-label {
     position: absolute;
     top: 50%;
     left: 100%;
     transform: translateY(-50%);
     opacity: 0;
     pointer-events: none;
     background: #1f3b4d;
     color: #f8ebd7;
     padding: 8px 18px;
     border-radius: 0 10px 10px 0;
     white-space: nowrap;
     font-size: 1em;
     font-weight: 600;
     transition: opacity 0.25s, left 0.2s;
     box-shadow: 2px 2px 14px rgba(31,59,77,0.15);
     z-index: 2;
   }
   .liwan-side-link:hover .liwan-icon-label {
     opacity: 1;
     pointer-events: auto;
     left: 65px;
   }
   .liwan-side-link i {
     margin: 0 auto;
     transition: color 0.17s;
   }
   @media (max-width: 600px) {
     .liwan-sidenav { width: 65px; }
     .liwan-side-link { width: 48px; height: 48px; font-size: 21px;}
     .liwan-side-link .liwan-icon-label { font-size: .99em; min-width: 55px; padding:7px 13px 7px 8px;}
   }
   /* ===== Chat Container ===== */
   .chat-container {
     width: 100%;
     max-width: 420px;
     height: 90vh;
     margin-right: 90px; /* Ù…Ø³Ø§Ø­Ø© Ù„Ù„Ø³Ø§ÙŠØ¯Ø¨Ø§Ø± */
     background: #ffffff;
     border-radius: 18px;
     box-shadow: 0 10px 30px rgba(0,0,0,0.12);
     display: flex;
     flex-direction: column;
     overflow: hidden;
   }
   .chat-header {
     background: #4c6b82;
     color: #fff;
     padding: 18px;
     text-align: center;
     font-size: 1.3rem;
     font-weight: 700;
   }
   .chat-messages {
     flex: 1;
     padding: 18px;
     overflow-y: auto;
     background: #fdfbf8;
     display: flex;
     flex-direction: column;
     gap: 12px;
   }
   .message {
     display: flex;
     align-items: flex-start;
     gap:10px;
   }
   .message img {
     width:42px;
     height:42px;
     border-radius:50%;
     object-fit:cover;
   }
   .message-content {
     background: #efe6dc;
     padding:12px 16px;
     border-radius:14px;
     max-width:75%;
   }
   .message-content .username {
     display:block;
     font-weight:700;
     font-size:0.95rem;
     color:#5a3f28;
     margin-bottom:4px;
   }
   .message-content .text {
     margin:0;
     font-size:1rem;
     line-height:1.6;
     color:#2b2b2b;
   }
   .chat-form {
     display: flex;
     align-items: center;
     padding:12px;
     border-top:1px solid #ddd;
     background: #fff;
   }
   .chat-avatar-small { width:38px; height:38px; border-radius:50%; margin-left:10px; }
   .chat-form input {
     flex:1;
     padding:10px 14px;
     border-radius:20px;
     border:1px solid #ccc;
     font-size:1rem;
   }
   .chat-form input:disabled { background:#eee; }
   .chat-form button {
     margin-right:10px;
     padding:10px 18px;
     border-radius:20px;
     border:none;
     background:#4c6b82;
     color:#fff;
     font-size:0.95rem;
     cursor:pointer;
   }
   .chat-form button:disabled {
     background:#bbb;
     cursor:not-allowed;
   }
   @media (max-width: 600px) {

body {
  align-items: stretch;
}

/* ===== Sidebar ===== */
.liwan-sidenav {
  width: 70px; /* Ø£Ø¹Ø±Ø¶ Ø´ÙˆÙŠ */
}

.liwan-side-link {
  width: 56px;
  height: 56px;
  font-size: 26px; /* ØªÙƒØ¨ÙŠØ± Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø© */
  border-radius: 14px;
}

.liwan-side-link i {
  font-size: 26px;
}

/* Ù†Ø®ÙÙŠ Ø§Ù„Ù†Øµ Ø¹Ø§Ù„ØªÙ„ÙÙˆÙ† */
.liwan-side-link .liwan-icon-label {
  display: none;
}

/* ===== Chat Container ===== */
.chat-container {
  margin-right: 75px; /* ÙŠØ²Ø¨Ø· Ù…Ø¹ Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø§ÙŠØ¯Ø¨Ø§Ø± */
  max-width: 100%;
  height: 100vh;
  border-radius: 0;
}

.chat-header {
  font-size: 1.15rem;
  padding: 14px;
}

.message img {
  width: 38px;
  height: 38px;
}

.message-content {
  max-width: 85%;
  font-size: 0.95rem;
}

.chat-form input {
  font-size: 0.95rem;
}

.chat-form button {
  font-size: 0.9rem;
  padding: 9px 14px;
}
}

 </style>
</head>
<body>
 <!-- ===== Sidebar ===== -->
 <nav class="liwan-sidenav" aria-label="Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ†Ù‚Ù„ Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ">
   <ul>
     <li><a href="home.html" class="liwan-side-link"><i class="fas fa-home"></i><span class="liwan-icon-label">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span></a></li>
     <li><a href="profile.html" class="liwan-side-link"><i class="fas fa-user-circle"></i><span class="liwan-icon-label">Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ</span></a></li>
     <li><a href="chat.html" class="liwan-side-link"><i class="fas fa-comments"></i><span class="liwan-icon-label">Ø§Ù„Ø¯Ø±Ø¯Ø´Ø©</span></a></li>
     <li><a href="activities.html" class="liwan-side-link"><i class="fas fa-calendar-alt"></i><span class="liwan-icon-label">Ø§Ù„Ø£Ù†Ø´Ø·Ø©</span></a></li>
     <li><a href="store.html" class="liwan-side-link"><i class="fas fa-store"></i><span class="liwan-icon-label">Ø§Ù„Ù…ØªØ¬Ø±</span></a></li>
     <li><a href="transport.html" class="liwan-side-link"><i class="fas fa-bus"></i><span class="liwan-icon-label">Ø§Ù„ØªÙ†Ù‚Ù„Ø§Øª</span></a></li>
     <li><a href="it-support.html" class="liwan-side-link"><i class="fas fa-headset"></i><span class="liwan-icon-label">Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ØªÙ‚Ù†ÙŠ</span></a></li>
     <li><a href="about.html" class="liwan-side-link"><i class="fas fa-circle-info"></i><span class="liwan-icon-label">Ø¹Ù† Ù„ÙŠÙˆØ§Ù†</span></a></li>
   </ul>
 </nav>
 <!-- ===== Chat Container ===== -->
 <div class="chat-container">
   <!-- Header -->
   <div class="chat-header"> Ù…Ø§Ø°Ø§ ÙŠØ¯ÙˆØ± ÙÙŠ Ø®Ø§Ø·Ø±ÙƒØŸğŸ’¬</div>
   <!-- Messages -->
   <div class="chat-messages" id="messagesContainer"></div>
   <!-- Login message -->
   <div class="chat-login-message" id="loginMsg" style="display:none;">Ø§Ù„Ø±Ø¬Ø§Ø¡ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù„Ù…Ø´Ø§Ø±ÙƒØ© ÙÙŠ Ø§Ù„Ø¯Ø±Ø¯Ø´Ø©.</div>
   <!-- Input form -->
   <form class="chat-form" id="chatForm" autocomplete="off">
     <img src="assets/avatar_default.png" id="currentUserAvatar" class="chat-avatar-small" alt="Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø´Ø®ØµÙŠØ©">
     <input type="text" id="messageInput" maxlength="200" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ Ù‡Ù†Ø§..." autocomplete="off" aria-label="Ù…Ø±Ø¨Ø¹ ÙƒØªØ§Ø¨Ø© Ø§Ù„Ø±Ø³Ø§Ù„Ø©">
     <button type="submit" id="sendBtn">Ø¥Ø±Ø³Ø§Ù„</button>
   </form>
 </div>
 <script type="module">
   import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
   import { getDatabase, ref, push, onChildAdded, serverTimestamp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js";
   const firebaseConfig = {
     apiKey: "AIzaSyAS2gyGru0SbM-3cPO0YXNPnIlSL9--Ibw",
     authDomain: "liwan-chat.firebaseapp.com",
     databaseURL: "https://liwan-chat-default-rtdb.europe-west1.firebasedatabase.app",
     projectId: "liwan-chat",
     storageBucket: "liwan-chat.firebasestorage.app",
     messagingSenderId: "385447003274",
     appId: "1:385447003274:web:177c97979d14acd7595973",
     measurementId: "G-E04REGJKHD"
   };
   const app = initializeApp(firebaseConfig);
   const database = getDatabase(app);
   // âœ… Ø¶Ø¨Ø· Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆØµÙˆØ±ØªÙ‡
   const currentUser = {
     name: localStorage.getItem("userName") || "Ø²Ø§Ø¦Ø±",
     avatar: localStorage.getItem("userAvatar") || "assets/avatar_default.png"
   };
   document.getElementById("currentUserAvatar").src = currentUser.avatar;
   const messageInput = document.getElementById("messageInput");
   const sendBtn = document.getElementById("sendBtn");
   const messagesContainer = document.getElementById("messagesContainer");
   sendBtn.addEventListener("click", e => {
     e.preventDefault();
     const text = messageInput.value.trim();
     if (!text) return;
     push(ref(database, "publicChat/messages"), {
       username: currentUser.name,
       avatar: currentUser.avatar,
       text: text,
       timestamp: serverTimestamp()
     });
     messageInput.value = "";
   });
   messageInput.addEventListener("keypress", e => {
     if (e.key === "Enter") sendBtn.click();
   });
   const messagesRef = ref(database, "publicChat/messages");
   onChildAdded(messagesRef, snapshot => {
     const msg = snapshot.val();
     displayMessage(msg);
   });
   function displayMessage(msg) {
     const messageEl = document.createElement("div");
     messageEl.classList.add("message");
     messageEl.innerHTML = `
       <img src="${msg.avatar}" class="avatar"/>
       <div class="message-content">
         <span class="username">${msg.username}</span>
         <span class="text">${msg.text}</span>
       </div>
     `;
     messagesContainer.appendChild(messageEl);
     messagesContainer.scrollTop = messagesContainer.scrollHeight;
   }
 </script>
</body>
</html>
